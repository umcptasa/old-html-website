{"version":3,"sources":["../../../src/utils/worker/page-data.js"],"names":["fs","require","path","Promise","getFilePath","publicDir","pagePath","fixedPagePath","join","updateJsonFileField","filename","fieldname","value","object","JSON","parse","readFile","outputFile","stringify","updateCompilationHashes","pagePaths","webpackCompilationHash","map","module","exports"],"mappings":";;AAAA,MAAMA,EAAE,GAAGC,OAAO,CAAE,UAAF,CAAlB;;AACA,MAAMC,IAAI,GAAGD,OAAO,CAAE,MAAF,CAApB;;AACA,MAAME,OAAO,GAAGF,OAAO,CAAE,UAAF,CAAvB;;AAEA,MAAMG,WAAW,GAAG,CAAC;AAAEC,EAAAA;AAAF,CAAD,EAAgBC,QAAhB,KAA6B;AAC/C,QAAMC,aAAa,GAAGD,QAAQ,KAAM,GAAd,GAAoB,OAApB,GAA6BA,QAAnD;AACA,SAAOJ,IAAI,CAACM,IAAL,CAAUH,SAAV,EAAsB,WAAtB,EAAkCE,aAAlC,EAAkD,gBAAlD,CAAP;AACD,CAHD;;AAKA,MAAME,mBAAmB,GAAG,OAAOC,QAAP,EAAiBC,SAAjB,EAA4BC,KAA5B,KAAsC;AAChE,QAAMC,MAAM,GAAGC,IAAI,CAACC,KAAL,EAAW,MAAMf,EAAE,CAACgB,QAAH,CAAYN,QAAZ,EAAuB,OAAvB,CAAjB,EAAf;AACAG,EAAAA,MAAM,CAACF,SAAD,CAAN,GAAoBC,KAApB;AACA,QAAMZ,EAAE,CAACiB,UAAH,CAAcP,QAAd,EAAwBI,IAAI,CAACI,SAAL,CAAeL,MAAf,CAAxB,EAAiD,OAAjD,CAAN;AACD,CAJD;;AAMA,MAAMM,uBAAuB,GAAG,CAC9B;AAAEd,EAAAA;AAAF,CAD8B,EAE9Be,SAF8B,EAG9BC,sBAH8B,KAK9BlB,OAAO,CAACmB,GAAR,CAAYF,SAAZ,EAAuBd,QAAQ,IAC7BG,mBAAmB,CACjBL,WAAW,CAAC;AAAEC,EAAAA;AAAF,CAAD,EAAgBC,QAAhB,CADM,EAEhB,wBAFgB,EAGjBe,sBAHiB,CADrB,CALF;;AAaAE,MAAM,CAACC,OAAP,GAAiB;AACfpB,EAAAA,WADe;AAEfe,EAAAA;AAFe,CAAjB","sourcesContent":["const fs = require(`fs-extra`)\nconst path = require(`path`)\nconst Promise = require(`bluebird`)\n\nconst getFilePath = ({ publicDir }, pagePath) => {\n  const fixedPagePath = pagePath === `/` ? `index` : pagePath\n  return path.join(publicDir, `page-data`, fixedPagePath, `page-data.json`)\n}\n\nconst updateJsonFileField = async (filename, fieldname, value) => {\n  const object = JSON.parse(await fs.readFile(filename, `utf-8`))\n  object[fieldname] = value\n  await fs.outputFile(filename, JSON.stringify(object), `utf-8`)\n}\n\nconst updateCompilationHashes = (\n  { publicDir },\n  pagePaths,\n  webpackCompilationHash\n) =>\n  Promise.map(pagePaths, pagePath =>\n    updateJsonFileField(\n      getFilePath({ publicDir }, pagePath),\n      `webpackCompilationHash`,\n      webpackCompilationHash\n    )\n  )\n\nmodule.exports = {\n  getFilePath,\n  updateCompilationHashes,\n}\n"],"file":"page-data.js"}